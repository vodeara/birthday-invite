<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ff6f61">
  <title>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è üéâ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* --- –°—Ç–∏–ª–∏ —Å—á—ë—Ç—á–∏–∫–∞ –æ–Ω–ª–∞–π–Ω-–≥–æ—Å—Ç–µ–π --- */
    #onlineBox {
      position: fixed;
      top: 15px;
      left: 15px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-weight: 600;
      font-size: 14px;
      padding: 8px 14px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 2000;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    #onlineDot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #28a745;
    }
  </style>
</head>

<body class="scene" id="body">

  <!-- üîπ –°—á—ë—Ç—á–∏–∫ –æ–Ω–ª–∞–π–Ω-–≥–æ—Å—Ç–µ–π -->
  <div id="onlineBox">
    <div id="onlineDot"></div>
    –û–Ω–ª–∞–π–Ω –≥–æ—Å—Ç–µ–π: <span id="onlineNumber">1</span>
  </div>

  <!-- –≠–∫—Ä–∞–Ω 1: –≥–ª–∞–≤–Ω–∞—è -->
  <section class="screen screen-home" id="homeScreen">
    <div class="iloveAlina">
      <h1>üéÇ –ú–æ–π –î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è!</h1>
      <p class="sub">–ù–∞–∂–º–∏ –Ω–∞ –º–µ–Ω—è</p>
      <button id="openBtn" class="open-btn">–û—Ç–∫—Ä—ã—Ç—å</button>
    </div>
  </section>

  <!-- iloveAlina) -->
  <section class="screen screen-invite" id="inviteScreen">
    <div class="invite-iloveAlina">
      <button id="closeBtn" class="close-btn">‚úï</button>
      <h1>üéâ –ü—Ä–∏–≥–ª–∞—à–∞—é —Ç–µ–±—è –Ω–∞ —Å–≤–æ–π –î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è!</h1>
      <p class="lead">
        –ë—É–¥—É —Ä–∞–¥ –≤–∏–¥–µ—Ç—å —Ç–µ–±—è <b>?? –¥–µ–∫–∞–±—Ä—è –≤ ??:00</b> —É –º–æ–µ–≥–æ –¥–æ–º–∞ ‚Äî –ü–µ—Ç—Ä–∞ –¢–∞—Ä–∞—Å–æ–≤–∞ 21.<br>
        –û—Ç—Ç—É–¥–∞ –º—ã –Ω–∞–ø—Ä–∞–≤–∏–º—Å—è –≤ <b>–ê–î–†–ï–°–°–ê–î–†–ï–°–°–ê–î–†–ï–°–°</b> –∏ —Ç–∞–º –±—É–¥–µ–º –¥–æ ?? –¥–µ–∫–∞–±—Ä—è ??:00 üéä
      </p>

      <div class="gifts">
        <h3>üéÅ –ò–¥–µ–∏ –ø–æ–¥–∞—Ä–∫–æ–≤</h3>
        <div class="gift-list">
          <a class="gift" href="https://followish.io/mywishlist/i4cxtz6hnymgxk" target="_blank" rel="noopener noreferrer">
            <div class="gift-icon">üéÅ</div>
            <span>–í–∏—à–ª–∏—Å—Ç</span>
          </a>
        </div>
      </div>

      <div class="controls">
        <button id="toggleMusic" class="music-btn">‚ñ∂ –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É</button>
      </div>
    </div>
  </section>

  <canvas id="confettiCanvas" class="confetti-canvas"></canvas>
  <audio id="bgMusic" src="music.mp3" loop></audio>

  <script src="confetti.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const openBtn = document.getElementById('openBtn');
      const closeBtn = document.getElementById('closeBtn');
      const body = document.getElementById('body');
      const bgMusic = document.getElementById('bgMusic');
      const toggleMusic = document.getElementById('toggleMusic');
      const confettiCanvas = document.getElementById('confettiCanvas');

      function openInvitation() {
        body.classList.add('flip');
        if (window.confettiStart) {
          confettiCanvas.style.display = 'block';
          window.confettiStart();
        }
        bgMusic.play().catch(() => {});
        toggleMusic.textContent = '‚è∏ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º—É–∑—ã–∫—É';
      }

      function closeInvitation() {
        body.classList.remove('flip');
        if (window.confettiStop) {
          confettiCanvas.style.display = 'none';
          window.confettiStop();
        }
        bgMusic.pause();
        toggleMusic.textContent = '‚ñ∂ –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
      }

      toggleMusic.addEventListener('click', () => {
        if (bgMusic.paused) {
          bgMusic.play();
          toggleMusic.textContent = '‚è∏ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º—É–∑—ã–∫—É';
        } else {
          bgMusic.pause();
          toggleMusic.textContent = '‚ñ∂ –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
        }
      });

      openBtn.addEventListener('click', openInvitation);
      closeBtn.addEventListener('click', closeInvitation);

      // --- WebSocket –¥–ª—è —Å—á—ë—Ç—á–∏–∫–∞ –≥–æ—Å—Ç–µ–π ---
      const userId = Math.random().toString(36).substr(2, 9);
      const socket = new WebSocket('wss://realtimeapi.io/api/live');

      socket.onopen = () => {
        socket.send(JSON.stringify({ event: 'join', room: 'birthday_invite_room', user: userId }));
      };

      socket.onmessage = (event) => {
        try {
          const data = JSON.parse(event.data);
          if (data.room === 'birthday_invite_room' && data.count !== undefined) {
            document.getElementById('onlineNumber').textContent = data.count;
          }
        } catch (e) {
          console.error('–û—à–∏–±–∫–∞ WebSocket:', e);
        }
      };

      window.addEventListener('beforeunload', () => {
        socket.send(JSON.stringify({ event: 'leave', room: 'birthday_invite_room', user: userId }));
      });
    });
  </script>
</body>
</html>

